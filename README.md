> [!NOTE]
> This README was generated by [Claude Code](https://github.com/neurowatt-dev/skill-readme-generate), get the ZH version from [here](./README.zh.md).

# go-notification-bot

> Multi-platform notification bot service integrating Discord, Slack, and LINE Bot with a unified API for message delivery and channel management.

## Table of Contents

- [Features](#features)
- [Architecture](#architecture)
- [Installation](#installation)
- [Configuration](#configuration)
- [Usage](#usage)
- [API Reference](#api-reference)
- [License](#license)
- [Author](#author)

## Features

- **Multi-platform Integration**: Support for Discord Webhook, Slack Webhook, and LINE Bot
- **Unified API**: Manage all notification channels through RESTful API
- **Discord Bot Commands**: Support for Slash Commands and traditional message commands
- **LINE Bot Interaction**: Automatic handling of follow/unfollow events and message commands
- **Stock Data Query**: Integrated GEX data lookup functionality
- **Batch Broadcasting**: LINE Bot supports batch message delivery to up to 500 users
- **Channel Management**: Dynamically add, remove, and list registered channels

## Architecture

```
cmd/
└── api/
    └── main.go          # Application entry point
internal/
├── channel/
│   ├── discord.go       # Discord Webhook send logic
│   └── slack.go         # Slack Webhook send logic
├── database/
│   ├── pg.go            # PostgreSQL connection management
│   ├── insertUser.go    # Insert user
│   ├── deleteUser.go    # Delete user
│   ├── selectUserLinebot.go  # Query LINE Bot users
│   └── selectTicker.go  # Query stock data
├── discord/
│   ├── discord.go       # Discord Handler initialization
│   ├── bot.go           # Discord Bot (Slash Command)
│   ├── send.go          # Send message
│   ├── add.go           # Add channel
│   └── delete.go        # Delete channel
├── linebot/
│   ├── webhook.go       # LINE Bot Webhook handler
│   ├── send.go          # Batch broadcast
│   ├── handleMessage.go # Message handling
│   └── commandGex.go    # GEX command
├── slack/
│   ├── slack.go         # Slack Handler initialization
│   ├── send.go          # Send message
│   ├── add.go           # Add channel
│   └── delete.go        # Delete channel
└── utils/
    └── utils.go         # Utility functions
```

## Installation

```bash
git clone https://github.com/pardnchiu/go-notification-bot.git
cd go-notification-bot
go mod download
```

## Configuration

Create a `.env` file with the following environment variables:

```env
LINEBOT_SECRET=your_line_channel_secret
LINEBOT_TOKEN=your_line_channel_access_token
DISCORD_TOKEN=your_discord_bot_token
```

## Usage

### Start the Server

```bash
go run cmd/api/main.go
```

The server starts on `:8080`.

### Discord Webhook

```bash
# Add channel
curl -X POST http://localhost:8080/discord/add \
  -H "Content-Type: application/json" \
  -d '{
    "datas": [
      {"name": "alerts", "webhook": "https://discord.com/api/webhooks/..."}
    ]
  }'

# Send message
curl -X POST http://localhost:8080/discord/alerts \
  -H "Content-Type: application/json" \
  -d '{
    "title": "System Alert",
    "description": "Server is up and running"
  }'
```

### Slack Webhook

```bash
# Add channel
curl -X POST http://localhost:8080/slack/add \
  -H "Content-Type: application/json" \
  -d '{
    "datas": [
      {"name": "general", "webhook": "https://hooks.slack.com/services/..."}
    ]
  }'

# Send message
curl -X POST http://localhost:8080/slack/general \
  -H "Content-Type: application/json" \
  -d '{
    "text": "Server is up and running"
  }'
```

### LINE Bot Broadcast

```bash
# Broadcast to all followers
curl -X POST http://localhost:8080/linebot/send/all \
  -H "Content-Type: application/json" \
  -d '{
    "text": "System announcement"
  }'
```

## API Reference

### Discord

| Method | Path | Description |
|--------|------|-------------|
| GET | `/discord/list` | List all registered channels |
| POST | `/discord/add` | Add channel |
| POST | `/discord/:channelName` | Send message to specified channel |
| DELETE | `/discord/:channelName` | Delete channel |

#### Discord Message Format

```json
{
  "title": "Title",
  "description": "Content",
  "url": "https://example.com",
  "color": "#FF5733",
  "timestamp": "2025-01-01T00:00:00Z",
  "image": "https://example.com/image.png",
  "thumbnail": "https://example.com/thumb.png",
  "fields": [
    {"name": "Field Name", "value": "Field Value", "inline": true}
  ],
  "footer": {"text": "Footer text"},
  "author": {"name": "Author Name"}
}
```

### Slack

| Method | Path | Description |
|--------|------|-------------|
| GET | `/slack/list` | List all registered channels |
| POST | `/slack/add` | Add channel |
| POST | `/slack/:channelName` | Send message to specified channel |
| DELETE | `/slack/:channelName` | Delete channel |

#### Slack Message Format

```json
{
  "text": "Message content",
  "title": "Title",
  "description": "Attachment content",
  "color": "#FF5733",
  "image": "https://example.com/image.png",
  "fields": [
    {"title": "Field Name", "value": "Field Value", "short": true}
  ],
  "footer": {"text": "Footer text"}
}
```

### LINE Bot

| Method | Path | Description |
|--------|------|-------------|
| POST | `/linebot/webhook` | LINE Webhook endpoint |
| POST | `/linebot/send/all` | Broadcast to all followers |

#### LINE Bot Message Format

```json
{
  "text": "Message content",
  "image": "https://example.com/image.png",
  "image_preview": "https://example.com/preview.png"
}
```

### Bot Commands

#### Discord

| Command | Description |
|---------|-------------|
| `/gex <ticker>` | Query GEX data for a stock ticker |
| `/help` | Show available commands |

#### LINE Bot

| Command | Description |
|---------|-------------|
| `/gex $<ticker>` | Query GEX data for a stock ticker |

## License

This project is private.

## Author

<img src="https://avatars.githubusercontent.com/u/25631760" align="left" width="96" height="96" style="margin-right: 0.5rem;">

<h4 style="padding-top: 0">邱敬幃 Pardn Chiu</h4>

<a href="mailto:dev@pardn.io" target="_blank">
<img src="https://pardn.io/image/email.svg" width="48" height="48">
</a> <a href="https://linkedin.com/in/pardnchiu" target="_blank">
<img src="https://pardn.io/image/linkedin.svg" width="48" height="48">
</a>

***

©️ 2026 [邱敬幃 Pardn Chiu](https://linkedin.com/in/pardnchiu)
